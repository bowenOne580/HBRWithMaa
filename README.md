# HBRWithMaa

## 介绍

本项目的大部分 `json` 文件是基于 [KarylDAZE/Maa-HBR: heaven burns red 炽焰天穹 自动化脚本](https://github.com/KarylDAZE/Maa-HBR) v0.5.9 版本修改而来，在保留原有功能的同时，加入了自定义战斗逻辑（排轴）的功能。使用本软件（即 HBRWithMaa），你可以在战斗时使用自己预先设定的轴，而不是 AUTO。

## 使用

1. 主程序

   推荐使用 `MFAAvalonia.exe`，带有 GUI 界面，**需要管理员身份运行**。

   对于需要使用命令行的用户，管理员身份运行 `MaaPiCli.exe`。

2. 其它工具

   解压 `\tools` 下的 `tools.zip` 压缩包，其中的两个 `exe` 之后会用到。

3. 作为 `Maa-HBR` 的插件

   下载 [plugin.zip](https://github.com/bowenOne580/HBRWithMaa/blob/main/plugin.zip)，解压后将所有文件复制到 `Maa-HBR` 的根目录下，之后运行 `Maa-HBR` 即可。

   另：如果弹出版本更新，则需要修改 `interface.json` 中的第三行 `version` 字段，将版本号替换为你下载的版本即可。由于本项目是基于 v0.5.9 版本修改而来，因此 `version` 默认也为此版本号。
   
   本机测试中，发现仍然需要管理员身份运行。若仍然无反应，请修改截图方式，还无反应则请提 issue。

## 分辨率设置注意事项

程序运行之前，一定要设置窗口比例为 16:9，且不能有边框（最上面的白色栏），否则会出现位置偏移，导致无法点到目标。

如果屏幕本身是 16:9 的，直接全屏运行即可。

**如果屏幕不是该比例，或者想要窗口化运行的，请先在游戏内调整分辨率至 16:9 且高于 720P 的档位，之后按照以下方式运行 tools 目录下的`无边框窗口化.exe`**：

1. 打开“无边框窗口化.exe”。
2. 在游戏刚打开时点 Home 键，直到窗口边框消失，但此时窗口分辨率仍可能不对，在登录完成，进入主页之前的加载时间狂点 Home 键，直到窗口再一次调整大小。
3. 使用截图工具（如 QQ 截图）验证窗口长宽是否和游戏内分辨率相同。

## 排轴规范

**目前尚不支持使用 OD 和使用 4 个及以上的技能！**

一个轴本质上是一个 `txt`，下面是其中应该包含的内容。

**第一行**是 6 个字符串，分别代表队伍初始状态下的六个人。

**第二行**是一个数字，表示轴的回合数。

**接下来的所有行**，每行 6 个数，填写技能编号，用 `,` 隔开（注意每行最后需要以 `,` 结尾），技能为 -1 代表后排，技能为 0 代表普攻，其它技能对应技能槽，目前仅支持前三个技能槽，可以看作一个人最多用三个不同的技能。

技能编号后面可以附加信息：

1. 对于需要指定对象的技能，用 `*x` 在技能编号之后表示对哪一个角色使用（这里的角色编号是第一行的中角色所处的位置，而不是当前回合角色实际的位置）。

2. 对于需要按照特定顺序站的前排，用 `/y` 在所有其它附加信息之后表示站位。

例如，`3*1/2` 表示使用 `Skill3`，对 `1` 号位角色使用，并且需要站在前排第 `2` 位。

请将轴写入 tools 目录下的 `Line.txt` 中。

在写好 `Line.txt` 后，运行 tools 目录下的 `gen.exe` 生成指定名称的 `json` 文件，将文件替换 `resource\pipeline` 下的同名文件即可。

示例：[驱动光球异侦Y.txt](https://github.com/bowenOne580/HBRWithMaa/blob/main/extra/驱动光球异侦Y.txt)
